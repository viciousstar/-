{% extends "base.html" %}
{% load staticfiles %}
{% load i18n %}
{% load usertag %}
{% block headblock %}
<link href="{% static "css/updateform.css" %}" rel="stylesheet">
{% endblock headblock %}
{% block content %}
<form action="" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-update">
        {% include "form_errors.html" %}
        <div class="row">
            <div class="col-md-8">
                <div class="form-group-lg">
                {{ form.username.errors }}
                {{ form.username.label_tag }}
                {{ form.username|add_attributes:'form-control,required:'}}
                </div>
                <div class="form-group-lg">
                {{ form.email.errors }}
                {{ form.email.label_tag }}
                {{ form.email|add_attributes:'form-control,required:'}}
                </div>
            </div>
            <div class="col-md-4">
                    <p><img src="{{ form.instance.avatar.url }}" width="100" height="100" class="avatar"/></p>
                <div class="form-group-lg">
                    <label for="avatar" class="sr-only"></label>
                    <input type="file" id="avatar" name="avatar">
                </div>
            </div>
        </div>
        {# may it can be handle in view, but it is too complication #}
        {% if request.path|is_current_user_profile:user %}
        <button type="submit" class="btn btn-primary">Update</button>
        <div class="text-center">
        <a href="{%url 'change_password' %}" class="btn btn-primary">Change Password</a>
        </div>
        {% else %}
        <div class="profile-button text-center">
        <a href="{%url 'messages_compose_to' form.username.value%}" class="btn btn-primary">Send Message</a>
        </div>
        {% endif %}
    </div>
</form>
{% endblock content %}